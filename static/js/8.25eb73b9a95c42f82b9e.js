webpackJsonp([8],{"B9i/":function(e,t){},BpPs:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("gyMJ"),o={data:function(){return{loading:!1,selectedPermit:{},permitList:[],moduleList:[]}},methods:{fetchPermitGroups:function(){var e=this;Object(n.a)("fetchPermitGroup").then(function(t){t&&(e.permitList=t)})},fetchModuleList:function(){var e=this;Object(n.a)("fetchAllModule").then(function(t){t&&(t.map(function(e){return e.isSwitch=!1}),e.moduleList=t)})},changePermit:function(e){var t=this;this.loading=!0,this.moduleList.map(function(e){return e.isSwitch=!1}),Object(n.a)("fetchPermitModule",{groupid:e.groupid}).then(function(e){if(t.loading=!1,!e||!e.length)return!1;e.forEach(function(e){"*"===e.module?t.moduleList.map(function(e){return e.isSwitch=!0}):t.moduleList.map(function(t){t.module_name===e.module&&(t.isSwitch=!0)})})})},resetPermit:function(e){if(this.selectedPermit.groupid){var t=this.moduleList[e];t.isSwitch?this.addPermitModule(t.module_name,e):this.removePermitModule(t.module_name,e)}},addPermitModule:function(e,t){var i=this;Object(n.a)("addPermitModule",{groupid:this.selectedPermit.groupid,module:e,actions:"*"}).then(function(e){e?ELEMENT.Message.success("操作成功"):i.moduleList[t].isSwitch=!1})},removePermitModule:function(e,t){var i=this;Object(n.a)("removePermitModule",{groupid:this.selectedPermit.groupid,module:e}).then(function(e){e?ELEMENT.Message.success("操作成功"):i.moduleList[t].isSwitch=!1})},createdPermit:function(){var e=this;ELEMENT.MessageBox.prompt("请输入权限组名称","新建权限组",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){var i=t.value;i?Object(n.a)("newPermitGroup",{parentid:"",name:i,desc:i}).then(function(t){t&&(ELEMENT.Message.success("操作成功"),e.fetchPermitGroups())}):ELEMENT.Message.error("名称不符合要求")}).catch(function(e){return console.log(e)})}},created:function(){this.fetchModuleList(),this.fetchPermitGroups()}},r={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container public-table"},[i("div",{staticClass:"group-header"},[i("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"选择或搜索权限组","value-key":"groupid"},on:{change:e.changePermit},model:{value:e.selectedPermit,callback:function(t){e.selectedPermit=t},expression:"selectedPermit"}},e._l(e.permitList,function(e){return i("el-option",{key:e.groupid,attrs:{label:e.name,value:e}})}))],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.moduleList,border:"",height:"calc(100% - 160px)"}},[i("el-table-column",{attrs:{label:"权限组",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.selectedPermit.name?e.selectedPermit.name:"未选择"))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"模块名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.zh_name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(i){e.resetPermit(t.$index)}},model:{value:t.row.isSwitch,callback:function(i){e.$set(t.row,"isSwitch",i)},expression:"scope.row.isSwitch"}})]}}])})],1),e._v(" "),i("el-button",{staticStyle:{width:"300px","margin-top":"20px"},attrs:{type:"primary"},on:{click:e.createdPermit}},[e._v("新建一个权限组")])],1)},staticRenderFns:[]};var c=i("VU/8")(o,r,!1,function(e){i("B9i/")},"data-v-32090577",null);t.default=c.exports}});
//# sourceMappingURL=8.25eb73b9a95c42f82b9e.js.map